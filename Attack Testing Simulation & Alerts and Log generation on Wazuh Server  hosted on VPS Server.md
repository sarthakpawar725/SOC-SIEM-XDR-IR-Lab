
# Attack Simulation ‚Äî Steps to Generate Alerts in Wazuh

## Preface
- Attacker: macOS Terminal
- Victim: Kali VM (has Wazuh Agent installed)
- SIEM: Wazuh on VPS
- IPs: replace <KALI_IP> and <MAC_IP> with your actual addresses

For each test:
1. Run the attack command(s) from your Mac terminal.
2. Wait ~10‚Äì60s for the agent to forward logs.
3. Open Wazuh Dashboard ‚Üí Security Events and apply the suggested filter/query.
---

## Attack 1 ‚Äî Simple failed SSH login (single attempt)
**Purpose:** Trigger authentication failure alert.

**From Mac:**
First we will scan for our victim machine and see Open Ports 
we can see that Port 22 is open lets ry to login with wrong Password initially.
ssh wronguser@<KALI_IP>

screenshot: 

<img width="500" height="500" alt="Screenshot 2025-11-30 at 21 36 09" src="https://github.com/user-attachments/assets/b1ce4aeb-24cf-4975-b9ba-666e29ff330b" />

**Wazuh Security information and Event Management:**
Alerts generated: We can see sshd authentication failed as we tried with wrong password, similarily we can brute force with wordlist for detail but as this is simualtion undertanding lab we will not do it ( Will Show in video )

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/ef1d9806-85b2-44d3-b35e-50bdad0a499b" />

## Attack 2: ‚ÄîSuccessful SSH login from attacker Mac to Kali

Purpose: Show a successful privileged login alert (root or other).

From Mac (if you have access or test account):

ssh testuser@<KALI_IP>
enter valid password:

<img width="500" height="500" alt="Screenshot 2025-11-30 at 21 52 55" src="https://github.com/user-attachments/assets/114d2f93-725d-4e71-9ea5-680d4b9ed763" />

Expected Wazuh alerts: Successful authentication /  IP login (if rule exists)

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/a0fb7542-7612-429d-9a6d-70951cc87b80" />

## Attack 3 ‚Äî Privilege escalation (sudo usage)

Purpose: Detect sudo or privilege escalation attempts.

On Kali (run inside the VM terminal or via ssh after login):
sudo su -     # or run a command with sudo like "sudo cat /etc/shadow"
provide password (valid)

Expected Wazuh alerts: Sudo command executed / privilege escalation / audit log entries

<img width="500" height="500" alt="Screenshot 2025-11-30 at 22 07 32" src="https://github.com/user-attachments/assets/5034313a-bd82-46bb-947f-b48f3a12b225" />

Wazuh Dashboard alerts: we can see sucessful logined as root user in kali from mac

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/ed9728a0-0a2f-4373-8f5c-92fdb98f6d6a" />

## 4. File Integrity Monitoring (FIM) Test

### **Configuration used on the Kali agent**
/var/ossec/etc/ossec.conf (syscheck block):



FIM Test Commands: Here we tried to make a file THISISTESTFILE.TXT in our /home directory where deployed wazuh agent monitoes that directory and send alets and logs.

<img width="500" height="500" alt="Screenshot 2025-12-01 at 14 28 22" src="https://github.com/user-attachments/assets/1d3f4506-a3b3-4743-8b5c-9b5cdd772f91" />


Wazuh Dashboard: In Security Events we can see the alets generated and logs of the files are seen. and further investigated  (sysheck)

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/1cb06fe5-f2d6-451b-96ae-5c74ecc8ee09" />

:Dahbboard info 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/6cdc3dff-10c1-4731-b0b2-3f663608697c" />

üìÑ Wazuh Integrity Monitoring Alert Explanation

The screenshot shows a File Integrity Monitoring (FIM) alert generated by the Wazuh agent running on the Kali machine. Wazuh detected the creation of a new file on the system and reported it to the Wazuh Manager, where it is indexed and displayed in the dashboard.

The alert corresponds to the file:

/home/monu/thisistestfile.txt



Wazuh detected this event using the Syscheck module, which monitors directories for file additions, modifications, and deletions. Because real-time monitoring is enabled, the alert was generated immediately when the file appeared on the system.

This event is associated with **Rule ID 554**, which corresponds to ‚ÄúFile added to the system.‚Äù The alert details include:

- **Agent information** (name, ID, and IP address)
- **Decoder used** (`syscheck_new_entry`), indicating a new file was detected
- **Full log message**, confirming the file path and that detection occurred in realtime mode
- **Timestamp and manager name**, showing when and where the alert was processed

This confirms that Wazuh is correctly monitoring the Kali system for file creation events and that the File Integrity Monitoring (FIM) functionality is working as intended.



